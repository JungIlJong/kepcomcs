<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kepco.app.domain.bbs.mapper.BbsMapper">

    <!-- 게시판의 상세정보를 조회한다. -->
    <select id="selectBbsDetail" parameterType="Long" resultType="searchBbs">
        SELECT
            A.BBS_ID,
            A.BBS_NM,
            A.BBS_TY_CODE,
            A.FILE_ATCH_SIZE,
            A.FILE_ATCH_CO,
            A.SECRET_USE_AT,
            A.ANSWER_AT,
            A.USE_AT,
            A.REPLY_AT,
            replace(A.PERM_EXTSN, ' ', '') PERM_EXTSN,
            VBA.AUTHOR_LIST
        FROM VST_BBS A
        LEFT OUTER JOIN VST_BBS_AUTHRT VBA ON VBA.BBS_ID = A.BBS_ID
        LEFT OUTER JOIN VST_AUTHRT VA ON VBA.AUTHRT_ID = VA.AUTHRT_ID
        WHERE A.BBS_ID = #{bbsId} AND A.USE_AT = 'Y'
        <choose>
            <when test="login == false">
                AND VA.AUTHRT_CD = 'ROLE_ANONYMOUS'
            </when>
            <otherwise>
                AND VA.AUTHRT_CD = 'ROLE_USER'
            </otherwise>
        </choose>
    </select>
</mapper>
